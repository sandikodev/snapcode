# Dynamic Configuration

http:
  # Routers
  routers:
    snapcode:
      rule: "Host(`snapcode.yourdomain.com`)"
      service: snapcode-service
      entryPoints:
        - websecure
      tls:
        certResolver: letsencrypt
      middlewares:
        - compression
        - ratelimit

  # Services (Load Balancing)
  services:
    snapcode-service:
      loadBalancer:
        servers:
          - url: "http://localhost:8000"
          - url: "http://localhost:8001"
          - url: "http://localhost:8002"
        
        # Health Check
        healthCheck:
          path: /
          interval: 10s
          timeout: 3s
        
        # Sticky Sessions
        sticky:
          cookie:
            name: snapcode_session
            secure: true
            httpOnly: true

  # Middlewares
  middlewares:
    compression:
      compress: {}
    
    ratelimit:
      rateLimit:
        average: 100
        burst: 50
    
    security-headers:
      headers:
        customResponseHeaders:
          X-Frame-Options: "SAMEORIGIN"
          X-Content-Type-Options: "nosniff"
          X-XSS-Protection: "1; mode=block"
